(this.webpackJsonpsevens=this.webpackJsonpsevens||[]).push([[0],{34:function(e,a,l){},36:function(e,a,l){},37:function(e,a,l){},38:function(e,a,l){},39:function(e,a,l){},46:function(e,a,l){"use strict";l.r(a);var t=l(1),n=l(3),c=l.n(n),d=l(22),r=l.n(d),u=(l(34),l(19)),s=l.n(u),o=l(23),p=l(4),i=(l(36),l(28)),y=l(21),v=(l(37),l(38),["AH","2H","3H","4H","5H","6H","7H","8H","9H","10H","JH","QH","KH","AC","2C","3C","4C","5C","6C","7C","8C","9C","10C","JC","QC","KC","AD","2D","3D","4D","5D","6D","7D","8D","9D","10D","JD","QD","KD","AS","2S","3S","4S","5S","6S","7S","8S","9S","10S","JS","QS","KS"]);function b(e){return{C:"\u2663",D:"\u2666",S:"\u2660",H:"\u2665"}[2===e.length?e.charAt(1):e.charAt(2)]}function j(e){return 2===e.length?e.substring(0,1):e.substring(0,2)}function f(e){console.log("Cards");var a,l={C:"card-black",D:"card-red",S:"card-black",H:"card-red"}[2===(a=e.value).length?a.charAt(1):a.charAt(2)],n=e.selected&&e.playable?"card-selected":"",c=e.selected&&!e.playable?" card-selected-not-playable bounce":"",d=b(e.value),r=j(e.value)+d,u="card-card "+n+(e.hidden?" card-hidden":"")+c,s="card-value "+l;return Object(t.jsx)("div",{className:u,onClick:e.onClick,children:Object(t.jsx)("div",{className:s,children:r})})}function h(e){console.log("myhand called with props.hand: ".concat(e.hand)),console.log("myhand called with props.playable: ".concat(e.playable)),console.log("myhand called with props.yourGo: ".concat(e.yourGo));var a=Object(n.useState)([]),l=Object(p.a)(a,2),c=l[0],d=l[1],r=Object(n.useState)("myhand-non-playable-knock"),u=Object(p.a)(r,2),s=u[0],o=u[1],v=Object(n.useRef)();Object(n.useEffect)((function(){console.log("setting hand"),e.hand&&v.current!==e.hand&&d((function(a){return e.hand.map((function(a){var l=!1;return-1!==e.playable.findIndex((function(e){return e===a}))&&(l=!0),{value:a,selected:!1,playable:l}}))})),v.current=e.hand}),[e.hand,e.playable]),Object(n.useEffect)((function(){console.log("applying props.playable"),e.playable&&d((function(a){return a.map((function(a){var l=!1;return-1!==e.playable.findIndex((function(e){return e===a.value}))&&(l=!0),{value:a.value,selected:a.selected,playable:l}}))}))}),[e.playable]);var b=Object(n.useRef)();return Object(n.useEffect)((function(){console.log("restoring card");var a=["AH","2H","3H","4H","5H","6H","7H","8H","9H","10H","JH","QH","KH","AC","2C","3C","4C","5C","6C","7C","8C","9C","10C","JC","QC","KC","AD","2D","3D","4D","5D","6D","7D","8D","9D","10D","JD","QD","KD","AS","2S","3S","4S","5S","6S","7S","8S","9S","10S","JS","QS","KS"];e.restoreCard&&b.current!==e.restoreCard&&d((function(l){var t=[].concat(Object(y.a)(l),[{value:e.restoreCard,selected:!1,playable:!1}]);return t.sort((function(e,l){return a.findIndex((function(a){return e.value===a}))-a.findIndex((function(e){return l.value===e}))})),t.map((function(a){var l=e.playable.findIndex((function(e){return e===a.value})),t=Object(i.a)({},a);return t.playable=-1!==l,t}))})),b.current=e.restoreCard}),[e.restoreCard,e.playable]),Object(t.jsx)("div",{className:"myhand-panel",children:Object(t.jsxs)("div",{className:"myhand-container",children:[c.length>0&&c.map((function(e,a){return Object(t.jsx)("div",{className:"myhand-card",children:Object(t.jsx)(f,{playable:e.playable,value:e.value,selected:e.selected,onClick:function(){!function(e){var a=c.map((function(a,l){return{value:a.value,playable:a.playable,selected:e===l}}));d(a)}(a)}})},a)})),e.yourGo&&Object(t.jsxs)("div",{class:"myhand-play-buttons",children:[Object(t.jsx)("input",{type:"button",onClick:function(){!function(){var a=c.findIndex((function(e){return e.selected&&e.playable}));if(console.log("selected: ".concat(a)),a>=0){var l=c[a].value,t=Object(y.a)(c);t.splice(a,1),e.playCard(l,t.length),d(t)}else alert("You must select a card first")}()},value:"Play Card"}),Object(t.jsx)("input",{type:"button",className:s,onClick:function(){!function(){var a=!1;c.forEach((function(l){-1!==e.playable.findIndex((function(e){return e===l.value}))&&(a=!0)})),a?o("myhand-playable-knock bounce"):(o("myhand-non-playable-knock"),e.knock())}()},value:"Knock"}),Object(t.jsx)("span",{children:"Your go!"})]})]})})}l(39);function O(e){var a=e.game.hearts.map((function(a,l){var n="cardtable-card cardtable-hearts "+(a.played?"":"cardtable-notplayed");return Object(t.jsx)("div",{className:n,children:Object(t.jsx)(f,{playable:"true",selected:"false",value:a.value+"H",hidden:!a.played,onClick:function(){return e.remove(a.value+"H")}})},l)})),l=e.game.clubs.map((function(a,l){var n="cardtable-card cardtable-clubs "+(a.played?"":"cardtable-notplayed");return Object(t.jsx)("div",{className:n,children:Object(t.jsx)(f,{playable:"true",selected:"false",value:a.value+"C",hidden:!a.played,onClick:function(){return e.remove(a.value+"C")}})},l)})),n=e.game.diamonds.map((function(a,l){var n="cardtable-card cardtable-diamonds "+(a.played?"":"cardtable-notplayed");return Object(t.jsx)("div",{className:n,children:Object(t.jsx)(f,{playable:"true",selected:"false",value:a.value+"D",hidden:!a.played,onClick:function(){return e.remove(a.value+"D")}})},l)})),c=e.game.spades.map((function(a,l){var n="cardtable-card cardtable-spades "+(a.played?"":"cardtable-notplayed");return Object(t.jsx)("div",{className:n,children:Object(t.jsx)(f,{playable:"true",selected:"false",value:a.value+"S",hidden:!a.played,onClick:function(){return e.remove(a.value+"S")}})},l)}));return Object(t.jsx)("div",{className:"cardtable-panel",children:Object(t.jsxs)("div",{className:"cardtable-container",children:[Object(t.jsx)("div",{className:"cardtable-hearts",children:a}),Object(t.jsx)("div",{className:"cardtable-clubs",children:l}),Object(t.jsx)("div",{className:"cardtable-diamonds",children:n}),Object(t.jsx)("div",{className:"cardtable-spades",children:c})]})})}var m=l(27);var g=function(){console.log("App called");var e=Object(n.useState)(),a=Object(p.a)(e,2),l=a[0],c=a[1],d=Object(n.useState)(""),r=Object(p.a)(d,2),u=r[0],i=r[1],y=Object(n.useState)([]),f=Object(p.a)(y,2),g=f[0],k=f[1],x=Object(n.useState)(),C=Object(p.a)(x,2),S=C[0],D=C[1],N=Object(n.useState)("start"),H=Object(p.a)(N,2),J=H[0],A=H[1],w=Object(n.useState)({hearts:[{value:"A",played:!1},{value:"2",played:!1},{value:"3",played:!1},{value:"4",played:!1},{value:"5",played:!1},{value:"6",played:!1},{value:"7",played:!1},{value:"8",played:!1},{value:"9",played:!1},{value:"10",played:!1},{value:"J",played:!1},{value:"Q",played:!1},{value:"K",played:!1}],clubs:[{value:"A",played:!1},{value:"2",played:!1},{value:"3",played:!1},{value:"4",played:!1},{value:"5",played:!1},{value:"6",played:!1},{value:"7",played:!1},{value:"8",played:!1},{value:"9",played:!1},{value:"10",played:!1},{value:"J",played:!1},{value:"Q",played:!1},{value:"K",played:!1}],diamonds:[{value:"A",played:!1},{value:"2",played:!1},{value:"3",played:!1},{value:"4",played:!1},{value:"5",played:!1},{value:"6",played:!1},{value:"7",played:!1},{value:"8",played:!1},{value:"9",played:!1},{value:"10",played:!1},{value:"J",played:!1},{value:"Q",played:!1},{value:"K",played:!1}],spades:[{value:"A",played:!1},{value:"2",played:!1},{value:"3",played:!1},{value:"4",played:!1},{value:"5",played:!1},{value:"6",played:!1},{value:"7",played:!1},{value:"8",played:!1},{value:"9",played:!1},{value:"10",played:!1},{value:"J",played:!1},{value:"Q",played:!1},{value:"K",played:!1}]}),K=Object(p.a)(w,2),Q=K[0],I=K[1],E=Object(n.useState)(),G=Object(p.a)(E,2),R=G[0],F=G[1],P=Object(n.useState)(["7D"]),W=Object(p.a)(P,2),Y=W[0],T=W[1],U=Object(n.useState)(0),B=Object(p.a)(U,2),L=B[0],M=B[1],q=Object(n.useState)({}),z=Object(p.a)(q,2),V=z[0],X=z[1],Z=Object(n.useState)(Date.now()),$=Object(p.a)(Z,2),_=$[0],ee=$[1],ae=Object(n.useState)(Date.now()),le=Object(p.a)(ae,2),te=le[0];function ne(e){return j(e)+b(e)}le[1],console.log("Player: ".concat(S)),Object(n.useEffect)((function(){console.log("App: setting up websocket");var e=window.location.hostname,a=new WebSocket("wss://"+e);a.onopen=function(e){console.log("Websocket opened")},a.onclose=function(e){console.log("Websocket closed!"),alert("Connection closed....")},setInterval(Object(o.a)(s.a.mark((function l(){return s.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return a.send(JSON.stringify({type:"ping"})),l.next=3,m.a.get("https://".concat(e,"/test.html"));case 3:l.sent,console.log("http GET performed");case 5:case"end":return l.stop()}}),l)}))),3e4),F(a)}),[]),Object(n.useEffect)((function(){function e(e,a){I((function(l){var t=2===e.length?e.charAt(1):e.charAt(2),n=2===e.length?e.substring(0,1):e.substring(0,2),c=!0;"play"===a?c=!0:"retract"===a&&(c=!1);var d={hearts:l.hearts.map((function(e){return"H"===t&&n===e.value?{value:e.value,played:c}:{value:e.value,played:e.played}})),clubs:l.clubs.map((function(e){return"C"===t&&n===e.value?{value:e.value,played:c}:{value:e.value,played:e.played}})),diamonds:l.diamonds.map((function(e){return"D"===t&&n===e.value?{value:e.value,played:c}:{value:e.value,played:e.played}})),spades:l.spades.map((function(e){return"S"===t&&n===e.value?{value:e.value,played:c}:{value:e.value,played:e.played}}))},r=["H","C","D","S"],u=[];return["hearts","clubs","diamonds","spades"].forEach((function(e,a){if(!1===d[e][6].played)u.push(d[e][6].value+r[a]);else{for(var l=7;l<13;l++)if(!1===d[e][l].played){u.push(d[e][l].value+r[a]);break}for(var t=5;t>=0;t--)if(!1===d[e][t].played){u.push(d[e][t].value+r[a]);break}}})),T(u),d}))}function a(){var e;console.log("New game called, player: ".concat(S)),M(0),A("start"),i("New game! - who has the the 7 of Diamonds?"),I({hearts:[{value:"A",played:!1},{value:"2",played:!1},{value:"3",played:!1},{value:"4",played:!1},{value:"5",played:!1},{value:"6",played:!1},{value:"7",played:!1},{value:"8",played:!1},{value:"9",played:!1},{value:"10",played:!1},{value:"J",played:!1},{value:"Q",played:!1},{value:"K",played:!1}],clubs:[{value:"A",played:!1},{value:"2",played:!1},{value:"3",played:!1},{value:"4",played:!1},{value:"5",played:!1},{value:"6",played:!1},{value:"7",played:!1},{value:"8",played:!1},{value:"9",played:!1},{value:"10",played:!1},{value:"J",played:!1},{value:"Q",played:!1},{value:"K",played:!1}],diamonds:[{value:"A",played:!1},{value:"2",played:!1},{value:"3",played:!1},{value:"4",played:!1},{value:"5",played:!1},{value:"6",played:!1},{value:"7",played:!1},{value:"8",played:!1},{value:"9",played:!1},{value:"10",played:!1},{value:"J",played:!1},{value:"Q",played:!1},{value:"K",played:!1}],spades:[{value:"A",played:!1},{value:"2",played:!1},{value:"3",played:!1},{value:"4",played:!1},{value:"5",played:!1},{value:"6",played:!1},{value:"7",played:!1},{value:"8",played:!1},{value:"9",played:!1},{value:"10",played:!1},{value:"J",played:!1},{value:"Q",played:!1},{value:"K",played:!1}]}),e=S,console.log("send hand request called, player: ".concat(e)),e&&R.send(JSON.stringify({type:"hand",player:e})),T(["7D"])}R&&(R.onmessage=function(l){console.log(l.data);var t,n,c=JSON.parse(l.data);switch(c.type){case"reset":D(""),k([]);break;case"card":t=c.nextplayer===S?"YOUR":"".concat(c.nextplayer,"'s"),A(c.nextplayer),0===c.left?i("".concat(c.player," played ").concat(ne(c.card)," and has WON!!!!!!!")):i("".concat(c.player," played ").concat(ne(c.card)," and has ").concat(c.left," card(s) left - ").concat(t," go...")),e(c.card,"play");break;case"knock":t=c.nextplayer===S?"YOUR":"".concat(c.nextplayer,"'s"),A(c.nextplayer),i("".concat(c.player," knocked! - ").concat(t," go..."));break;case"retractCard":var d=j(c.card),r=b(c.card);i("".concat(c.player," retracted card ").concat(d+r)),e(c.card,"retract"),A(c.player);break;case"message":i("".concat(c.message));break;case"newgame":a();break;case"kitty":M(c.kitty),X(c.knocks);break;case"hand":n=c.cards,console.log("Update hand called with ".concat(n)),n.sort((function(e,a){return v.findIndex((function(a){return e===a}))-v.findIndex((function(e){return a===e}))})),k(n);break;case"echo":ee(Date.now());break;default:console.log("unsupported message type")}})}),[R,S]);var ce="";function de(e){R.send(JSON.stringify({type:"register",player:e})),D(e)}var re=["...","John","Nancy","Allen","Gavin","Eric"].map((function(e){return Object(t.jsx)("option",{value:e,children:e})}));console.log("App: player = ".concat(S,", nextPlayer = ").concat(J));var ue=Math.round((_-te)/1e3);return Object(t.jsxs)("div",{className:"App",children:[!S&&Object(t.jsxs)("div",{className:"app-register",children:[Object(t.jsx)("h1",{children:"Sevens!"}),Object(t.jsx)("label",{htmlFor:"players",children:"Choose a predefined player:"}),Object(t.jsx)("select",{value:S,name:"players",id:"players",onChange:function(e){"..."!==e.target.value&&de(e.target.value)},children:re}),Object(t.jsx)("div",{children:"...or enter a different name:"}),Object(t.jsx)("input",{type:"text",onChange:function(e){ce=e.target.value}}),Object(t.jsx)("input",{type:"button",value:"Register new name",onClick:function(){de(ce)}})]}),S&&Object(t.jsxs)("div",{className:"app-controls-and-hand",children:[Object(t.jsxs)("div",{className:"app-controls",children:["John"===S&&Object(t.jsx)("div",{className:"app-container",children:Object(t.jsxs)("div",{className:"app-playerselecter",children:[Object(t.jsx)("div",{children:Object(t.jsx)("span",{children:ue})}),Object(t.jsx)("div",{children:Object(t.jsx)("input",{type:"button",onClick:function(){R.send(JSON.stringify({type:"newgame"}))},value:"New Game"})}),Object(t.jsx)("div",{children:Object(t.jsx)("input",{type:"button",onClick:function(){L&&V.players&&alert("Kitty: "+L+"p\n"+V.players[0]+" knocked "+V.knocks[0]+" times\n"+V.players[1]+" knocked "+V.knocks[1]+" times\n"+V.players[2]+" knocked "+V.knocks[2]+" times\n"+V.players[3]+" knocked "+V.knocks[3]+" times\n")},value:"Kitty"})}),Object(t.jsx)("div",{children:Object(t.jsx)("input",{type:"button",onClick:function(){R.send(JSON.stringify({type:"reset"}))},value:"Reset Session"})})]})}),Object(t.jsx)("div",{children:Object(t.jsxs)("div",{className:"app-log",children:[u," - kitty: ",L,"p"]})})]}),Object(t.jsx)(h,{yourGo:J===S||"start"===J,playable:Y,hand:g,playCard:function(e,a){c(""),R.send(JSON.stringify({type:"card",player:S,left:a,card:e}))},knock:function(){R.send(JSON.stringify({type:"knock",player:S})),R.send(JSON.stringify({type:"kitty"}))},restoreCard:l})]}),S&&Object(t.jsx)(O,{game:Q,remove:function(e){window.confirm("Are you sure you want to retract the ".concat(e,"?"))&&(c(e),R.send(JSON.stringify({type:"retractCard",player:S,card:e})))}})]})},k=function(e){e&&e instanceof Function&&l.e(3).then(l.bind(null,47)).then((function(a){var l=a.getCLS,t=a.getFID,n=a.getFCP,c=a.getLCP,d=a.getTTFB;l(e),t(e),n(e),c(e),d(e)}))};r.a.render(Object(t.jsx)(c.a.StrictMode,{children:Object(t.jsx)(g,{})}),document.getElementById("root")),k()}},[[46,1,2]]]);
//# sourceMappingURL=main.caa20b47.chunk.js.map